#!/usr/bin/env bash

set -e

DEBUG=${DEBUG:-''}
[ -n "${DEBUG}" ] && set -x

SRC=${1:-''}
DST=${2:-''}
RSYNCOPTS="${RSYNCOPTS:-""}"

# check if src is btrfs volume, fails and stops the script if not
/bin/btrfs subvolume show $SRC > /dev/null

echo Backup $SRC to $DST
/usr/bin/rsync --archive --delete $RSYNCOPTS "${SRC}" "${DST}"
